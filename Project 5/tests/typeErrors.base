$ Lines where errors should occur have !!-style comments
$ Multiple errors are separated by commas
$ Legend for errors:
$ +----+---------------------------------------------------+
$ |  1 |           Write attempt of function name          |
$ |  2 |            Write attempt of tuple name            |
$ |  3 |          Write attempt of tuple variable          |
$ |  4 |               Write attempt of void               |
$ |  5 |           Read attempt of function name           |
$ |  6 |             Read attempt of tuple name            |
$ |  7 |           Read attempt of tuple variable          |
$ |  8 |            Call attempt on non-function           |
$ |  9 |         Function call with wrong # of args        |
$ | 10 |       Actual type does not match formal type      |
$ | 11 |                Return value missing               |
$ | 12 |         Return with value in void function        |
$ | 13 |              Return value wrong type              |
$ | 14 | Arithmetic operator used with non-integer operand |
$ | 15 | Relational operator used with non-integer operand |
$ | 16 |   Logical operator used with non-logical operand  |
$ | 17 |    Non-logical expression used in if condition    |
$ | 18 |   Non-logical expression used in while condition  |
$ | 19 |                  Mismatched type                  |
$ | 20 |  Equality operator used with void function calls  |
$ | 21 |     Equality operator used with function names    |
$ | 22 |      Equality operator used with tuple names      |
$ | 23 |    Equality operator used with tuple variables    |
$ | 24 |            Assignment to function name            |
$ | 25 |              Assignment to tuple name             |
$ | 26 |            Assignment to tuple variable           |
$ +----+---------------------------------------------------+


integer double{integer x} [
  return x * False. !! 13,14| Cannot multiply with False ---
]

tuple User {
    integer age.
    logical student.
}.

tuple User user.

void set_user_age{logical age} [
    return (user:age = age). !! 12,19| ---
]

integer get_user_age{} [
    $ Apparently multiple returns is not a problem
    return user:student. !! 13|
    return user:student. !! 13|
    return user:student. !! 13|
]

logical is_user_a_student{} [
    return user:age. !! 13|
]

!! Okay, now we do sequential testing

!!!!!!!!!!!!!!!!!!!!!!!  Write attempt of function name  !!!!!!!!!!!!!!!!!!!!!!!
void WAOFN{} [
    $ Function level
    write << double. !! 1|

    $ in IF stmt
    if False [ write << WAOFN. ] !! 1|

    $ in IF-ELSE stmt
    if True [ write << set_user_age. ] !! 1|
    else [ write << get_user_age. ] !! 1|

    $ in WHILE stmt
    while False [ write << is_user_a_student. ] !! 1|
]

!!!!!!!!!!!!!!!!!!!!!!!!!  Write attempt of tuple name  !!!!!!!!!!!!!!!!!!!!!!!!
void WAOTN{} [
    $ Function level
    write << User. !! 2|

    $ in IF stmt
    if False [ write << User. ] !! 2|

    $ in IF-ELSE stmt
    if True [ write << User. ] !! 2|
    else [ write << User. ] !! 2|

    $ in WHILE stmt
    while False [ write << User. ] !! 2|
]

!!!!!!!!!!!!!!!!!!!!!!!  Write attempt of tuple variable  !!!!!!!!!!!!!!!!!!!!!!
void WAOTV{} [
    $ Function level
    write << user. !! 3|

    $ in IF stmt
    if False [ write << user. ] !! 3|

    $ in IF-ELSE stmt
    if True [ write << user. ] !! 3|
    else [ write << user. ] !! 3|

    $ in WHILE stmt
    while False [ write << user. ] !! 3|
]

!!!!!!!!!!!!!!!!!!!!!!!!!!!!  Write attempt of void  !!!!!!!!!!!!!!!!!!!!!!!!!!!
void WAOV{} [
    $ Function level
    write << set_user_age(False). !! 4|

    $ in IF stmt
    if False [ write << WAOFN(). ] !! 4|

    $ in IF-ELSE stmt
    if True [ write << WAOTN(). ] !! 4|
    else [ write << WAOTV(). ] !! 4|

    $ in WHILE stmt
    while False [ write << WAOV(). ] !! 4|
]

!!!!!!!!!!!!!!!!!!!!!!!  Read attempt of function name  !!!!!!!!!!!!!!!!!!!!!!!!
void RAOFN{} [
    $ Function level
    read >> double. !! 5|

    $ in IF stmt
    if False [ read >> RAOFN. ] !! 5|

    $ in IF-ELSE stmt
    if True [ read >> set_user_age. ] !! 5|
    else [ read >> get_user_age. ] !! 5|

    $ in WHILE stmt
    while False [ read >> is_user_a_student. ] !! 5|
]

!!!!!!!!!!!!!!!!!!!!!!!!!  Read attempt of tuple name  !!!!!!!!!!!!!!!!!!!!!!!!!
void RAOTN{} [
    $ Function level
    read >> User. !! 6|

    $ in IF stmt
    if False [ read >> User. ] !! 6|

    $ in IF-ELSE stmt
    if True [ read >> User. ] !! 6|
    else [ read >> User. ] !! 6|

    $ in WHILE stmt
    while False [ read >> User. ] !! 6|
]

!!!!!!!!!!!!!!!!!!!!!!!  Read attempt of tuple variable  !!!!!!!!!!!!!!!!!!!!!!!
void RAOTV{} [
    $ Function level
    read >> user. !! 7|

    $ in IF stmt
    if False [ read >> user. ] !! 7|

    $ in IF-ELSE stmt
    if True [ read >> user. ] !! 7|
    else [ read >> user. ] !! 7|

    $ in WHILE stmt
    while False [ read >> user. ] !! 7|
]

!!!!!!!!!!!!!!!!!!!!!!!!  Call attempt on non-function  !!!!!!!!!!!!!!!!!!!!!!!!
void CAONF{} [
    integer caonf.
    $ Function level
    caonf(). !! 8|

    $ in IF stmt
    if False [ caonf(). ] !! 8|

    $ in IF-ELSE stmt
    if True [ caonf(). ] !! 8|
    else [ caonf(). ] !! 8|

    $ in WHILE stmt
    while False [ caonf(). ] !! 8|

    $ in ASSIGN stmt
    caonf = caonf(). !! 8|
    user:age = caonf(). !! 8|

    $ in IF condition stmt
    if caonf() [] !! 8,17| ---

    $ in IF-ELSE condition stmt
    if caonf() [] !! 8,17| ---
    else []

    $ in WHILE condition stmt
    while caonf() [] !! 8,18| ---

    $ in RETURN stmt
    return caonf(). !! 8,12|  ---
]

!!!!!!!!!!!!!!!!!!!!!  Function call with wrong # of args  !!!!!!!!!!!!!!!!!!!!!
logical FCWWNOA_func{integer a, integer b, logical c} []

logical FCWWNOA{} [
    integer fcwwnoa.
    $ Function level
    double(). !! 9|

    $ in IF stmt
    if False [ FCWWNOA_func(1, 2). ] !! 9|

    $ in IF-ELSE stmt
    if True [ double(False, user:age). ] !! 9|
    else [ FCWWNOA_func(True, fcwwnoa). ] !! 9|

    $ in WHILE stmt
    while False [ double(12, False). ] !! 9|

    $ in ASSIGN stmt
    fcwwnoa = FCWWNOA_func(True, 42). !! 9|
    user:age = double(100, fcwwnoa, 100). !! 9|

    $ in IF condition stmt
    if FCWWNOA_func("what", user:student) [] !! 9,17| ---

    $ in IF-ELSE condition stmt
    if FCWWNOA_func() [] !! 9,17| ---
    else []

    $ in WHILE condition stmt
    while double(600, True, fcwwnoa) [] !! 9,18| ---

    $ in RETURN stmt
    return FCWWNOA_func(0). !! 9,13|
]

!!!!!!!!!!!!!!!!!!!  Actual type does not match formal type  !!!!!!!!!!!!!!!!!!!
logical ATDNMFT_func{logical a, integer b, logical c} []
logical ATDNMFT{} [
    logical atdnmft.
    $ Function level
    double(True). !! 10|

    $ in IF stmt
    if False [ double(False). ] !! 10|

    $ in IF-ELSE stmt
    if True [ double(user:student). ] !! 10|
    else [ double("atdnmft"). ] !! 10|

    $ in WHILE stmt
    while False [ ATDNMFT_func(1, False, 2). ] !! 10|

    $ in ASSIGN stmt
    atdnmft = ATDNMFT_func(True, True, True). !! 10|
    user:student = ATDNMFT_func(0, 1, 2). !! 10|

    $ in IF condition stmt
    if double("str") [] !! 10,17| ---

    $ in IF-ELSE condition stmt
    if ATDNMFT_func("logical", "False", "1") [] !! 10| ---
    else []

    $ in WHILE condition stmt
    while ATDNMFT_func(1, True, 0) [] !! 10| ---

    $ in RETURN stmt
    return ATDNMFT_func(0, 0, 0). !! 10|
]

!!!!!!!!!!!!!!!!!!!!!!!!!!!!  Return value missing  !!!!!!!!!!!!!!!!!!!!!!!!!!!!
integer RVM{} [
    $ Function level
    return. !! 11|

    $ in IF stmt
    if False [ return. ] !! 11|

    $ in IF-ELSE stmt
    if True [ return. ] !! 11|
    else [ return. ] !! 11|

    $ in WHILE stmt
    while False [ return. ] !! 11|
]
